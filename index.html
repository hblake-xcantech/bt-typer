<!doctype html>
<title>iOS Audio Test</title>
<button id="unlock">Unlock & Play Tone</button>
<div id="status"></div>
<script>
let actx;
document.getElementById('unlock').onclick = async () => {
  if (!actx) actx = new (window.AudioContext||window.webkitAudioContext)();
  if (actx.state !== 'running') {
    try { await actx.resume(); } catch(e){ console.log('resume failed', e); }
  }
  document.getElementById('status').textContent = 'Context: ' + actx.state;
  const osc = actx.createOscillator();
  const gain = actx.createGain();
  gain.gain.value = 0.5;
  osc.frequency.value = 1000;
  osc.connect(gain); gain.connect(actx.destination);
  osc.start();
  setTimeout(()=>osc.stop(), 1000);
};
</script>
